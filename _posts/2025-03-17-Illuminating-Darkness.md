---
title: Latent Intrinsics Meets Diffusion Models for Indoor Scene Relighting
author: liliazhen669
date: 2025-03-18 18:00:00 +0800
categories: [Learning, Relighting]
tags: [paper] # TAG names should always be lowercas
render_with_liquid: false
math: true
---


> 论文链接：*[LumiNet](https://arxiv.org/pdf/2412.00177)*


## Abstract

本文提出了一个利用生成模型和潜在本质以实现高效光照传输的新颖模型。本文提出的方法有两个主要贡献点：基于StyleGan重光照模型的数据构造策略以及能够处理来自源图像的潜在本质表示和来自目标图像的潜在外在表示的ControlNet。本文还通过一个将目标图像的潜在外在表示通过交叉注意力和微调UNet的方式插入到去噪网络的可学习的MLP来增强光照传输。具体来说，LumiNet的目标是在保持源场景的几何结构（Geometry）和材质（Material）的同时，将目标光照图像的光照特性转移到源图像上，生成逼真的重光照效果

## Introduction And Related Work

### 解决的过去方法的问题

传统方法的局限性：

- 传统逆渲染方法：传统方法通常通过逆渲染（inverse rendering）来分解场景的光照、材质和几何信息，然后重新渲染。然而，这些方法通常依赖于显式的3D重建和材质建模，计算成本高且容易受到模型误差的影响。
- 多视图方法：一些方法依赖于多视图图像来获取更丰富的场景信息，但这需要复杂的设备设置和大量的数据采集工作。
- 单图像方法：单图像方法虽然简化了输入要求，但在处理复杂的光照现象（如镜面高光、间接光照等）时表现不佳，尤其是在不同场景之间进行光照转移时。
现有生成模型的局限性：
- StyleGAN：虽然StyleGAN的潜在空间可以解耦光照信息，但其生成的图像与真实图像之间存在差距，难以直接应用于真实图像的重光照任务。
- 扩散模型（Diffusion Models）：现有的扩散模型在生成条件图像方面表现出色，但在处理复杂室内场景的光照转移时，仍然存在局限性，尤其是在跨场景光照转移时。

### 创新点和主要贡献

- 新颖的框架：LumiNet结合了潜在内在控制和扩散模型，能够在不需要3D或多视图输入的情况下，实现高质量的室内场景重光照。
- 据生成策略：通过变分StyleGAN方法，LumiNet能够生成多样化的训练数据，解决了真实室内场景在不同光照条件下的数据稀缺问题。
- 泛化能力：尽管LumiNet仅在相同场景的光照对上进行训练，但它能够成功地在不同布局和材质的场景之间进行光照转移。
- 逼真的光照效果：LumiNet能够生成复杂的光照现象，如镜面高光、投射阴影和间接光照，生成的结果在物理上具有合理性。

## Method

LuminNet基于将图像分离为光照无关（本质表示）和光照相关（外在表示）成分的光度立体理论，在训练期间利用了潜在本质表示（Geometry和Material）

### Latent Intrinsic Extraction

基于像素空间的传统图像分解方法面临两个挑战：1）仅仅依靠单张图片的分解过程是不定的；2）获取分解后的所有组件的计算量是很大的，因此本文选择在隐空间中处理本质信息.基于 [Latent intrinsics emerge from training to relight](), 给定场景 $S_{o}$ 在不同的光照条件 $L_{o}$ 和 $L_{t}$ 下所构成的图像对 $(S_{o}^{L_{o}},S_{o}^{L_{t}})$ ，使用一个预训练的潜在本质编码器 $f_{\lambda}$ 来提取潜在本质特征 $\mathcal{A}_{o} \in \mathbb{R}^{H\plus W \plus 128}$ 和光照编码 $$，

### Latent Intrinsic Control

不同于作用于Image维度的ControlNet，LumiNet在潜在空间中进行光照控制。具体而言：首先，目标光照编码通过一个MLP（即一个Adaptor）被扩展并与源图像的潜在内在特征拼接，形成一个新的特征图，这个特征图通过一个卷积层处理成一个中间特征表示；然后，通过扩散模型的交叉注意力机制来增强光照控制，光照编码会通过已学习的MLP投影到和Text Embedding对齐的维度上， 特别地，本文**移除文本输入**来实现完全基于图像的重光照

### Training Objective

在训练过程中，本文通过潜在扩散过程专注于同场景的Lighting Transfer。过程可以描述如下，首先将目标光照下的场景 $S^{L_{t}}$ 通过VAE编码成潜在变量 $\mathcal{E}(S^{L_{t}})$，然后逐步地向该潜在变量中添加噪声来获得 $\mathcal{E}(S^{L_{t}})_t$。去噪网络根据条件输入 $t$ 和 潜变量 $$  来预测噪声，目标函数可以描述如下：

其中，在训练过程中，仅训练交叉注意力层的参数以及潜在本质控制网络的权重，而其他扩散模型的组件的权重则保持不变